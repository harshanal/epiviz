% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/age_sex_pyramid.R
\name{age_sex_pyramid}
\alias{age_sex_pyramid}
\title{Generate an Age-Sex Pyramid}
\usage{
age_sex_pyramid(
  dynamic = FALSE,
  base = NULL,
  params = list(df, var_map = list(age = "age", date_of_birth = "date_of_birth", sex =
    "sex", age_group = "age_group", value = "value", lowercl = "lowercl", uppercl =
    "uppercl"), colours = c("#440154", "#2196F3"), x_breaks = 10, y_title =
    "Age group (years)", x_title = "Number of cases", text_size = 12, conf_limits =
    FALSE, age_breakpoints = c(0, 5, 19, 65, Inf), age_calc_refdate = Sys.Date(), grouped
    = FALSE, legend_position = "top", legend_title = "")
)
}
\arguments{
\item{dynamic}{Logical. If \code{TRUE}, the function returns an interactive plotly chart. If \code{FALSE}, a static ggplot chart is returned.}

\item{base}{An optional base plot to add the pyramid to. Default is \code{NULL}.}

\item{params}{A list of parameters including:
\describe{
\item{df}{Data frame containing the data to be used.}
\item{var_map}{A list mapping variable names in the data frame to the expected names used in the function.
\describe{
\item{age}{Name of the column containing age values. Default is \code{'age'}.}
\item{date_of_birth}{Name of the column containing date of birth values. Default is \code{'date_of_birth'}.}
\item{sex}{Name of the column containing sex values. Default is \code{'sex'}.}
\item{age_group}{Name of the column containing pre-grouped age groups (if \code{grouped = TRUE}).}
\item{value}{Name of the column containing the value counts (if \code{grouped = TRUE}).}
\item{lowercl}{Name of the column containing lower confidence limits (if \code{conf_limits = TRUE}).}
\item{uppercl}{Name of the column containing upper confidence limits (if \code{conf_limits = TRUE}).}
}
}
\item{colours}{A vector of colours to be used in the plot. Default is \code{c("#440154", "#fde725")}.}
\item{x_breaks}{Number of breaks on the x-axis. Default is \code{10}.}
\item{y_title}{Title of the y-axis. Default is \code{"Individual count"}.}
\item{x_title}{Title of the x-axis. Default is \code{"Number of cases"}.}
\item{text_size}{Size of the text in the plot. Default is \code{12}.}
\item{conf_limits}{Logical. If \code{TRUE}, confidence limits are displayed on the pyramid. Default is \code{FALSE}.}
\item{age_breakpoints}{A numeric vector specifying the breakpoints for age groups. Default is \code{c(0, 5, 19, 65, Inf)}.}
\item{age_calc_refdate}{Reference date for calculating age from date of birth. Default is \code{Sys.Date()}.}
\item{grouped}{Logical. If \code{TRUE}, assumes the data is pre-grouped by age and sex. If \code{FALSE}, the function processes the line list data. Default is \code{FALSE}.}
\item{legend_position}{Position of the legend. Default is \code{"top"}.}
\item{legend_title}{Title of the legend. Default is \code{""}.}
}}
}
\value{
A ggplot or plotly object representing the age-sex pyramid, depending on the value of \code{dynamic}.
}
\description{
This function creates an age-sex pyramid visualization, either as a static ggplot or an interactive plotly chart.
The function can take either a line list (ungrouped data) or already grouped data as input.
When using a line list, the function processes the data, groups it by age and sex, and then generates the pyramid.
If grouped data is provided, it directly creates the pyramid.
}
\details{
When \code{grouped = FALSE}, the function processes a line list by grouping the data by age and sex,
calculating age based on either the provided age column or date of birth, and then generating the age-sex pyramid.
When \code{grouped = TRUE}, it assumes the data is already grouped and uses the provided values directly to generate the pyramid.
}
\examples{
\dontrun{
# Example using a line list
df <- epiviz::lab_data
age_sex_pyramid(
  dynamic = FALSE,
  params = list(
    df = df,
    var_map = list(age = 'age', date_of_birth = 'date_of_birth', sex = 'sex'),
    grouped = FALSE
  )
)

# Example using pre-grouped data
grouped_df <- data.frame(
  age_group = c("0-4", "5-18", "19-64", "65+"),
  sex = c("Male", "Female"),
  value = c(100, 120, 150, 80),
  lowercl = c(90, 110, 140, 70),
  uppercl = c(110, 130, 160, 90)
)
age_sex_pyramid(
  dynamic = FALSE,
  params = list(
    df = grouped_df,
    var_map = list(age_group = 'age_group', sex = 'sex', value = 'value'),
    grouped = TRUE
  )
)
}

}
